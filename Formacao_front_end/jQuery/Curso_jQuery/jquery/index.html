<html>

<head>
    <link rel="stylesheet" type="text/css" href="carrinho.css">
</head>

<body>
    <div class="carrinho">
        <h2>Carrinho entrega em Sao Paulo</h2>
        <table>
            <thead>
                <tr>
                    <td></td>
                    <td>Nome</td>
                    <td>Quantidade</td>
                    <td>Valor</td>
                    <td>Total</td>
                    <td></td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><img src="imagens/tablet.jpg"></td>
                    <td>Tablet miPad 18</td>
                    <td>1</td>
                    <td>499.99</td>
                    <td class="item-total">499.99</td>
                    <td><a class="remove-item" href="">(Remover)</a></td>
                </tr>
                <tr>
                    <td><img src="imagens/telefone.png"></td>
                    <td>Telefone miPhone 18</td>
                    <td>2</td>
                    <td>199.99</td>
                    <td class="item-total">399.98</td>
                    <td><a class="remove-item" href="">(Remover)</a></td>
                </tr>
                <tr>
                    <td><img src="imagens/sapato.jpg"></td>
                    <td>Sapato</td>
                    <td>1</td>
                    <td>99.99</td>
                    <td class="item-total">99.99</td>
                    <td><a class="remove-item" href="">(Remover)</a></td>
                </tr>
                <tr>
                    <td><img src="imagens/monitor.jpg"></td>
                    <td>Monitor Sam 21</td>
                    <td>1</td>
                    <td>299.00</td>
                    <td class="item-total">299.00</td>
                    <td><a class="remove-item" href="">(Remover)</a></td>
                </tr>
                <tr>
                    <td><img src="imagens/teclado.jpg"></td>
                    <td>Teclado com fio preto </td>
                    <td>1</td>
                    <td>100.00</td>
                    <td class="item-total">100.00</td>
                    <td><a class="remove-item" href="">(Remover)</a></td>
                </tr>
                <tr>
                    <td><img src="imagens/mouse.jpg"></td>
                    <td>Mouse wireless</td>
                    <td>1</td>
                    <td>199.00</td>
                    <td class="item-total">199.00</td>
                    <td><a class="remove-item" href="">(Remover)</a></td>
                </tr>
                <tr>
                    <td><img src="imagens/camiseta.jpg"></td>
                    <td>Camiseta G</td>
                    <td>1</td>
                    <td>25.00</td>
                    <td class="item-total">25.00</td>
                    <td><a class="remove-item" href="">(Remover)</a></td>
                </tr>
            </tbody>
        </table>
    </div>


</body>
<div>
    Valor total: R$<span id="valor-total">0</span> <br> Total de itens: <span id="total-itens">0</span>
</div>
<!--deixar sempre o carregamento dos scripts para o final da página, 
assim ao executar os códigos abaixo, náo bloqueia a escrita da 
página-->
<script src="scripts/jQuery/jquery-2.0.3.min.js"></script>
<script>
    var removeItem = function(event) {
        //parâmetro enviado no click
        //podemos executar a função preventDefault
        //que privine o comportamente default
        //que é enviar para alguma página depois de clicar no link
        event.preventDefault();
        //Quado uma função é invocada, via callback é passado
        //para a função, e essa refência é o this
        //o this aqui é o link
        var self = $(this);
        //para remover a linha da tabela, precisamos chegar 
        //no pai dele, para isso precisamos chegar ele pela função parent
        //self.parent().parent().remove();

        //Não é trivial sair acessando parent após parent
        //para isso temos o seletor closest
        //que sai navegando na arvore, procurando a primeira 
        //incidência do seletor passado
        self.closest("tr").remove();

        var totalItem = parseInt($("#total-itens").text());
        var novaQtd = totalItem - 1;
        $("#total-itens").text(novaQtd);
    };
    var aposInicializado = function() {
        var itens = $(".item-total");
        var total = 0;
        for (var i = 0; i < itens.length; i++) {
            //Recuperando o td e tranformando em um objeto jQeury
            var item = $(itens[i]);
            // gera uma nova variável com a conversào do 
            //texto para ponto flutuante para poder 
            //fazer o calculo.
            var valor = parseFloat(item.text());
            total += valor;
        }
        console.log("Valor total: " + total);
        $("#valor-total").text(total);
        $("#total-itens").text(itens.length);
        $(".remove-item").click(removeItem);

    };
    //Toda função passada desta forma para o 
    //jQuery só vai ser executada após o total 
    //carregamento da página
    $(aposInicializado);
    $(alert('Outras bibliotecas javascript: Prototype, Ext JS, JQuery UI, Mustache, Prime UI'));
</script>

</html>